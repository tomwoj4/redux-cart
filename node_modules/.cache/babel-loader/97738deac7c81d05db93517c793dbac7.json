{"ast":null,"code":"import _regeneratorRuntime from\"/Users/tomwojcik/Desktop/React/advanced-redux/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/tomwojcik/Desktop/React/advanced-redux/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import{uiActions}from'./ui-slice';import{cartActions}from'./cart-slice';export var fetchCartData=function fetchCartData(){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var fetchData,cartData;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:fetchData=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return fetch(\"https://react-backend-a6844-default-rtdb.europe-west1.firebasedatabase.app/cart.json\");case 2:response=_context.sent;if(response.ok){_context.next=5;break;}throw new Error('Could not fetch cart data!');case 5:_context.next=7;return response.json();case 7:data=_context.sent;return _context.abrupt(\"return\",data);case 9:case\"end\":return _context.stop();}}},_callee);}));return function fetchData(){return _ref2.apply(this,arguments);};}();_context2.prev=1;_context2.next=4;return fetchData();case 4:cartData=_context2.sent;dispatch(cartActions.replaceCart({items:cartData.items||[],totalQuantity:cartData.totalQuantity}));_context2.next=11;break;case 8:_context2.prev=8;_context2.t0=_context2[\"catch\"](1);dispatch(uiActions.showNotification({status:'error',title:'Error!',message:'Fetching cart data failed!'}));case 11:case\"end\":return _context2.stop();}}},_callee2,null,[[1,8]]);}));return function(_x){return _ref.apply(this,arguments);};}();};export var sendCartData=function sendCartData(cart){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(dispatch){var sendRequest;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:dispatch(uiActions.showNotification({status:'pending',title:'Sending...',message:'Sending cart data!'}));sendRequest=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var response;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return fetch(\"https://react-backend-a6844-default-rtdb.europe-west1.firebasedatabase.app/cart.json\",{method:'PUT',body:JSON.stringify({items:cart.items,totalQuantity:cart.totalQuantity})});case 2:response=_context3.sent;if(response.ok){_context3.next=5;break;}throw new Error('Sending cart data failed.');case 5:case\"end\":return _context3.stop();}}},_callee3);}));return function sendRequest(){return _ref4.apply(this,arguments);};}();_context4.prev=2;_context4.next=5;return sendRequest();case 5:dispatch(uiActions.showNotification({status:'success',title:'Success!',message:'Sent cart data successfully!'}));_context4.next=11;break;case 8:_context4.prev=8;_context4.t0=_context4[\"catch\"](2);dispatch(uiActions.showNotification({status:'error',title:'Error!',message:'Sending cart data failed!'}));case 11:case\"end\":return _context4.stop();}}},_callee4,null,[[2,8]]);}));return function(_x2){return _ref3.apply(this,arguments);};}();};","map":{"version":3,"sources":["/Users/tomwojcik/Desktop/React/advanced-redux/src/store/cart-actions.js"],"names":["uiActions","cartActions","fetchCartData","dispatch","fetchData","fetch","response","ok","Error","json","data","cartData","replaceCart","items","totalQuantity","showNotification","status","title","message","sendCartData","cart","sendRequest","method","body","JSON","stringify"],"mappings":"qUAAA,OAASA,SAAT,KAA0B,YAA1B,CACA,OAASC,WAAT,KAA4B,cAA5B,CAEA,MAAO,IAAMC,CAAAA,aAAa,CAAG,QAAhBA,CAAAA,aAAgB,EAAM,CACjC,+FAAO,kBAAOC,QAAP,6IACCC,SADD,2FACa,2KACOC,CAAAA,KAAK,CAC1B,sFAD0B,CADZ,QACVC,QADU,kBAKXA,QAAQ,CAACC,EALE,8BAMR,IAAIC,CAAAA,KAAJ,CAAU,4BAAV,CANQ,8BASGF,CAAAA,QAAQ,CAACG,IAAT,EATH,QASVC,IATU,+CAWTA,IAXS,wDADb,kBACCN,CAAAA,SADD,oFAgBoBA,CAAAA,SAAS,EAhB7B,QAgBGO,QAhBH,gBAiBHR,QAAQ,CACNF,WAAW,CAACW,WAAZ,CAAwB,CACtBC,KAAK,CAAEF,QAAQ,CAACE,KAAT,EAAkB,EADH,CAEtBC,aAAa,CAAEH,QAAQ,CAACG,aAFF,CAAxB,CADM,CAAR,CAjBG,mFAwBHX,QAAQ,CACNH,SAAS,CAACe,gBAAV,CAA2B,CACzBC,MAAM,CAAE,OADiB,CAEzBC,KAAK,CAAE,QAFkB,CAGzBC,OAAO,CAAE,4BAHgB,CAA3B,CADM,CAAR,CAxBG,sEAAP,+DAiCD,CAlCM,CAoCP,MAAO,IAAMC,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,CAACC,IAAD,CAAU,CACpC,gGAAO,kBAAOjB,QAAP,sIACLA,QAAQ,CACNH,SAAS,CAACe,gBAAV,CAA2B,CACzBC,MAAM,CAAE,SADiB,CAEzBC,KAAK,CAAE,YAFkB,CAGzBC,OAAO,CAAE,oBAHgB,CAA3B,CADM,CAAR,CAQMG,WATD,2FASe,4KACKhB,CAAAA,KAAK,CAC1B,sFAD0B,CAE1B,CACEiB,MAAM,CAAE,KADV,CAEEC,IAAI,CAAEC,IAAI,CAACC,SAAL,CAAe,CACnBZ,KAAK,CAAEO,IAAI,CAACP,KADO,CAEnBC,aAAa,CAAEM,IAAI,CAACN,aAFD,CAAf,CAFR,CAF0B,CADV,QACZR,QADY,mBAYbA,QAAQ,CAACC,EAZI,+BAaV,IAAIC,CAAAA,KAAJ,CAAU,2BAAV,CAbU,yDATf,kBASCa,CAAAA,WATD,oFA2BGA,CAAAA,WAAW,EA3Bd,QA6BHlB,QAAQ,CACNH,SAAS,CAACe,gBAAV,CAA2B,CACzBC,MAAM,CAAE,SADiB,CAEzBC,KAAK,CAAE,UAFkB,CAGzBC,OAAO,CAAE,8BAHgB,CAA3B,CADM,CAAR,CA7BG,mFAqCHf,QAAQ,CACNH,SAAS,CAACe,gBAAV,CAA2B,CACzBC,MAAM,CAAE,OADiB,CAEzBC,KAAK,CAAE,QAFkB,CAGzBC,OAAO,CAAE,2BAHgB,CAA3B,CADM,CAAR,CArCG,sEAAP,iEA8CD,CA/CM","sourcesContent":["import { uiActions } from './ui-slice';\nimport { cartActions } from './cart-slice';\n\nexport const fetchCartData = () => {\n  return async (dispatch) => {\n    const fetchData = async () => {\n      const response = await fetch(\n        \"https://react-backend-a6844-default-rtdb.europe-west1.firebasedatabase.app/cart.json\"\n);\n\n      if (!response.ok) {\n        throw new Error('Could not fetch cart data!');\n      }\n\n      const data = await response.json();\n\n      return data;\n    };\n\n    try {\n      const cartData = await fetchData();\n      dispatch(\n        cartActions.replaceCart({\n          items: cartData.items || [],\n          totalQuantity: cartData.totalQuantity,\n        })\n      );\n    } catch (error) {\n      dispatch(\n        uiActions.showNotification({\n          status: 'error',\n          title: 'Error!',\n          message: 'Fetching cart data failed!',\n        })\n      );\n    }\n  };\n};\n\nexport const sendCartData = (cart) => {\n  return async (dispatch) => {\n    dispatch(\n      uiActions.showNotification({\n        status: 'pending',\n        title: 'Sending...',\n        message: 'Sending cart data!',\n      })\n    );\n\n    const sendRequest = async () => {\n      const response = await fetch(\n        \"https://react-backend-a6844-default-rtdb.europe-west1.firebasedatabase.app/cart.json\",\n        {\n          method: 'PUT',\n          body: JSON.stringify({\n            items: cart.items,\n            totalQuantity: cart.totalQuantity,\n          }),\n        }\n      );\n\n      if (!response.ok) {\n        throw new Error('Sending cart data failed.');\n      }\n    };\n\n    try {\n      await sendRequest();\n\n      dispatch(\n        uiActions.showNotification({\n          status: 'success',\n          title: 'Success!',\n          message: 'Sent cart data successfully!',\n        })\n      );\n    } catch (error) {\n      dispatch(\n        uiActions.showNotification({\n          status: 'error',\n          title: 'Error!',\n          message: 'Sending cart data failed!',\n        })\n      );\n    }\n  };\n};"]},"metadata":{},"sourceType":"module"}